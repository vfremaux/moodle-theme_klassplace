/**
 * Contain the logic for a drawer.
 *
 * @copyright  2021 Valery Fremaux, Nicolas Maligue
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_klassplace/spdrawer",["jquery","core/custom_interaction_events","core/log"],(function($,CustomEvents,Log){var SELECTORS_TOGGLE_REGION='[data-region="spdrawer-toggle"]',SELECTORS_TOGGLE_ACTION='[data-action="toggle-spdrawer"]',SELECTORS_BODY="body",SELECTORS_SECTION='.list-group-item[href*="#section-"]',SPDrawer=function(){$(SELECTORS_TOGGLE_REGION).length||Log.debug("Page is missing a spdrawer region"),$(SELECTORS_TOGGLE_ACTION).length||Log.debug("Page is missing a spdrawer toggle link"),$(SELECTORS_TOGGLE_REGION).each(function(index,ele){var trigger=$(ele).find(SELECTORS_TOGGLE_ACTION),drawerid=trigger.attr("aria-controls"),drawer=$(document.getElementById(drawerid)),hidden="false"==trigger.attr("aria-expanded"),side=trigger.attr("data-side"),body=$(SELECTORS_BODY);drawer.on("mousewheel DOMMouseScroll",this.preventPageScroll),hidden?trigger.attr("aria-expanded","false"):(body.addClass("spdrawer-open-"+side),trigger.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners(),$(document).width()<768&&this.closeAll()};return SPDrawer.prototype.closeAll=function(){$(SELECTORS_TOGGLE_REGION).each((function(index,ele){var trigger=$(ele).find(SELECTORS_TOGGLE_ACTION),side=trigger.attr("data-side"),body=$(SELECTORS_BODY),drawerid=trigger.attr("aria-controls"),drawer=$(document.getElementById(drawerid)),preference=trigger.attr("data-preference");trigger.attr("aria-expanded","false"),body.removeClass("drawer-open-"+side),drawer.attr("aria-hidden","true"),drawer.addClass("closed"),M.util.set_user_preference(preference,"false")}))},SPDrawer.prototype.toggleDrawer=function(e){var trigger=$(e.target).closest("[data-action=toggle-spdrawer]"),drawerid=trigger.attr("aria-controls"),drawer=$(document.getElementById(drawerid)),body=$(SELECTORS_BODY),side=trigger.attr("data-side"),preference=trigger.attr("data-preference");body.addClass("drawer-ease"),"true"==trigger.attr("aria-expanded")?(body.removeClass("drawer-open-"+side),trigger.attr("aria-expanded","false"),drawer.attr("aria-hidden","true"),drawer.addClass("closed"),trigger.children("i").removeClass("fa-arrow-right"),trigger.children("i").addClass("fa-arrow-left"),M.util.set_user_preference(preference,"false")):(trigger.attr("aria-expanded","true"),drawer.attr("aria-hidden","false"),drawer.focus(),body.addClass("drawer-open-"+side),drawer.removeClass("closed"),trigger.children("i").removeClass("fa-arrow-left"),trigger.children("i").addClass("fa-arrow-right"),M.util.set_user_preference(preference,"true"))},SPDrawer.prototype.preventPageScroll=function(e){var delta=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.originalEvent.detail,bottomOverflow=this.scrollTop+$(this).outerHeight()-this.scrollHeight>=0,topOverflow=this.scrollTop<=0;(delta<0&&bottomOverflow||delta>0&&topOverflow)&&e.preventDefault()},SPDrawer.prototype.registerEventListeners=function(){$(SELECTORS_TOGGLE_ACTION).each(function(index,element){CustomEvents.define($(element),[CustomEvents.events.activate]),$(element).on(CustomEvents.events.activate,function(e,data){this.toggleDrawer(data.originalEvent),data.originalEvent.preventDefault()}.bind(this))}.bind(this)),$(SELECTORS_SECTION).click(function(){$(document).width()<768&&this.closeAll()}.bind(this))},{init:function(){return new SPDrawer}}}));

//# sourceMappingURL=spdrawer.min.js.map